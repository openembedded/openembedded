diff -u'rNF^function' php-5.1.4~/acinclude.m4 php-5.1.4/acinclude.m4
--- php-5.1.4~/acinclude.m4	2006-04-10 08:17:36.000000000 -0400
+++ php-5.1.4/acinclude.m4	2006-08-16 22:32:58.000000000 -0400
@@ -818,10 +818,10 @@
   OVERALL_TARGET=[]ifelse($1,,php,$1)
   php_c_pre='$(LIBTOOL) --mode=compile $(CC)'
   php_c_meta='$(COMMON_FLAGS) $(CFLAGS_CLEAN) $(EXTRA_CFLAGS)'
-  php_c_post=
+  php_c_post=' && echo "[#] Generated by PHP badness - GNU libtool" > $[@] && echo "pic_object=none" >> $[@] && echo "non_pic_object=$[@]" | sed -e "s,=.*/,=,; s,\.lo,\.o,g" >> $[@]'
   php_cxx_pre='$(LIBTOOL) --mode=compile $(CXX)'
   php_cxx_meta='$(COMMON_FLAGS) $(CXXFLAGS_CLEAN) $(EXTRA_CXXFLAGS)'
-  php_cxx_post=
+  php_cxx_post=' && echo "[#] Generated by PHP badness - GNU libtool" > $[@] && echo "pic_object=none" >> $[@] && echo "non_pic_object=$[@]" | sed -e "s,=.*/,=,; s,\.lo,\.o,g" >> $[@]'
   php_lo=lo
 
   case $with_pic in
@@ -1670,6 +1670,7 @@
       have_fopen_cookie=yes
 
 dnl even newer glibcs have a different seeker definition...
+AC_CACHE_CHECK([if cookie io functions use off64_t], php_cv_lib_cookie_io_functions_use_off64_t,
 AC_TRY_RUN([
 #define _GNU_SOURCE
 #include <stdio.h>
@@ -1702,10 +1703,11 @@
   cookie_io_functions_use_off64_t=yes
 ], [
   cookie_io_functions_use_off64_t=no
-], [
-  cookie_io_functions_use_off64_t=no
-])
-    
+],
+[ php_cv_lib_cookie_io_functions_use_off64_t=yes ],
+[ php_cv_lib_cookie_io_functions_use_off64_t=no ] ))
+
+
     else
 
 dnl older glibc versions (up to 2.1.2 ?)
diff -u'rNF^function' php-5.1.4~/configure.in php-5.1.4/configure.in
--- php-5.1.4~/configure.in	2006-05-03 19:30:02.000000000 -0400
+++ php-5.1.4/configure.in	2006-08-16 20:39:19.000000000 -0400
@@ -209,6 +209,7 @@
 
 sinclude(Zend/Zend.m4)
 sinclude(TSRM/tsrm.m4)
+sinclude(TSRM/threads.m4)
 
 
 divert(2)
@@ -255,11 +255,6 @@
   PTHREADS_FLAGS
 fi

-if test "$PHP_ENABLE_FASTCGI" = "yes"; then
-  PHP_CONFIGURE_PART(Running FastCGI checks)
-  sinclude(sapi/cgi/libfcgi/acinclude.m4)
-  sinclude(sapi/cgi/libfcgi/libfcgi.m4)
-fi

 divert(3)

diff -u'rNF^function' php-5.1.4~/scripts/phpize.m4 php-5.1.4/scripts/phpize.m4
--- php-5.1.4~/scripts/phpize.m4	2006-04-10 08:16:17.000000000 -0400
+++ php-5.1.4/scripts/phpize.m4	2006-08-16 20:39:19.000000000 -0400
@@ -3,7 +3,6 @@
 divert(1)
 
 AC_PREREQ(2.13)
-AC_INIT(config.m4)
 
 PHP_CONFIG_NICE(config.nice)
 
@@ -69,8 +68,6 @@
 PHP_PROG_RE2C
 PHP_PROG_AWK
     
-sinclude(config.m4)
-
 enable_static=no
 enable_shared=yes
 
diff -u'rNF^function' php-5.1.4~/TSRM/threads.m4 php-5.1.4/TSRM/threads.m4
--- php-5.1.4~/TSRM/threads.m4	2005-04-27 09:22:18.000000000 -0400
+++ php-5.1.4/TSRM/threads.m4	2006-08-16 20:39:19.000000000 -0400
@@ -86,7 +86,7 @@
   pthreads_working=no
   ], [
   dnl For cross compiling running this test is of no use. NetWare supports pthreads
-  pthreads_working=no
+  pthreads_working=yes
   case $host_alias in
   *netware*)
     pthreads_working=yes
